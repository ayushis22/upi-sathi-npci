{"ast":null,"code":"var _s = $RefreshSig$();\n// src/hooks/useVoice.js\nimport { useEffect, useRef, useState } from 'react';\nexport const useVoice = ({\n  onCommand\n}) => {\n  _s();\n  const recognitionRef = useRef(null);\n  const [listening, setListening] = useState(false);\n  const [error, setError] = useState(null);\n  const shouldListenRef = useRef(false);\n  const restartTimeoutRef = useRef(null);\n  useEffect(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      setError('Speech Recognition not supported in this browser');\n      return;\n    }\n    const recognition = new window.webkitSpeechRecognition();\n    recognition.lang = 'en-IN';\n    recognition.continuous = true;\n    recognition.interimResults = false;\n    recognition.onresult = event => {\n      const transcript = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();\n      console.log('ðŸŽ¤ Heard:', transcript);\n      onCommand === null || onCommand === void 0 ? void 0 : onCommand(transcript);\n    };\n    recognition.onerror = e => {\n      console.error('Voice error:', e);\n      if (e.error === 'aborted' || e.error === 'no-speech') {\n        if (shouldListenRef.current) {\n          if (restartTimeoutRef.current) {\n            clearTimeout(restartTimeoutRef.current);\n          }\n          restartTimeoutRef.current = setTimeout(() => {\n            try {\n              var _recognitionRef$curre;\n              (_recognitionRef$curre = recognitionRef.current) === null || _recognitionRef$curre === void 0 ? void 0 : _recognitionRef$curre.start();\n              setListening(true);\n            } catch (err) {\n              // ignore\n            }\n          }, 250);\n        }\n        return;\n      }\n      setError(e.error);\n      setListening(false);\n    };\n    recognition.onend = () => {\n      setListening(false);\n      if (shouldListenRef.current) {\n        if (restartTimeoutRef.current) {\n          clearTimeout(restartTimeoutRef.current);\n        }\n        restartTimeoutRef.current = setTimeout(() => {\n          try {\n            var _recognitionRef$curre2;\n            (_recognitionRef$curre2 = recognitionRef.current) === null || _recognitionRef$curre2 === void 0 ? void 0 : _recognitionRef$curre2.start();\n            setListening(true);\n          } catch (err) {\n            // ignore\n          }\n        }, 250);\n      }\n    };\n    recognitionRef.current = recognition;\n    return () => {\n      if (restartTimeoutRef.current) {\n        clearTimeout(restartTimeoutRef.current);\n      }\n      recognition.stop();\n    };\n  }, [onCommand]);\n  const startListening = () => {\n    shouldListenRef.current = true;\n    if (recognitionRef.current && !listening) {\n      recognitionRef.current.start();\n      setListening(true);\n    }\n  };\n  const stopListening = (options = {}) => {\n    var _recognitionRef$curre3;\n    if (!options.temporary) {\n      shouldListenRef.current = false;\n    }\n    (_recognitionRef$curre3 = recognitionRef.current) === null || _recognitionRef$curre3 === void 0 ? void 0 : _recognitionRef$curre3.stop();\n    setListening(false);\n  };\n  return {\n    listening,\n    startListening,\n    stopListening,\n    error\n  };\n};\n_s(useVoice, \"wxQLZfs7l+zKJwcLcKxPdZhJJGQ=\");","map":{"version":3,"names":["useEffect","useRef","useState","useVoice","onCommand","_s","recognitionRef","listening","setListening","error","setError","shouldListenRef","restartTimeoutRef","window","recognition","webkitSpeechRecognition","lang","continuous","interimResults","onresult","event","transcript","results","length","trim","toLowerCase","console","log","onerror","e","current","clearTimeout","setTimeout","_recognitionRef$curre","start","err","onend","_recognitionRef$curre2","stop","startListening","stopListening","options","_recognitionRef$curre3","temporary"],"sources":["/Users/abhayagarwal/IdeaProjects/UPI-saathi/frontend/src/hooks/useVoice.js"],"sourcesContent":["// src/hooks/useVoice.js\nimport { useEffect, useRef, useState } from 'react';\n\nexport const useVoice = ({ onCommand }) => {\n  const recognitionRef = useRef(null);\n  const [listening, setListening] = useState(false);\n  const [error, setError] = useState(null);\n  const shouldListenRef = useRef(false);\n  const restartTimeoutRef = useRef(null);\n\n  useEffect(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      setError('Speech Recognition not supported in this browser');\n      return;\n    }\n\n    const recognition = new window.webkitSpeechRecognition();\n    recognition.lang = 'en-IN';\n    recognition.continuous = true;\n    recognition.interimResults = false;\n\n    recognition.onresult = (event) => {\n      const transcript =\n        event.results[event.results.length - 1][0].transcript.trim().toLowerCase();\n      console.log('ðŸŽ¤ Heard:', transcript);\n      onCommand?.(transcript);\n    };\n\n    recognition.onerror = (e) => {\n      console.error('Voice error:', e);\n      if (e.error === 'aborted' || e.error === 'no-speech') {\n        if (shouldListenRef.current) {\n          if (restartTimeoutRef.current) {\n            clearTimeout(restartTimeoutRef.current);\n          }\n          restartTimeoutRef.current = setTimeout(() => {\n            try {\n              recognitionRef.current?.start();\n              setListening(true);\n            } catch (err) {\n              // ignore\n            }\n          }, 250);\n        }\n        return;\n      }\n      setError(e.error);\n      setListening(false);\n    };\n\n    recognition.onend = () => {\n      setListening(false);\n      if (shouldListenRef.current) {\n        if (restartTimeoutRef.current) {\n          clearTimeout(restartTimeoutRef.current);\n        }\n        restartTimeoutRef.current = setTimeout(() => {\n          try {\n            recognitionRef.current?.start();\n            setListening(true);\n          } catch (err) {\n            // ignore\n          }\n        }, 250);\n      }\n    };\n\n    recognitionRef.current = recognition;\n\n    return () => {\n      if (restartTimeoutRef.current) {\n        clearTimeout(restartTimeoutRef.current);\n      }\n      recognition.stop();\n    };\n  }, [onCommand]);\n\n  const startListening = () => {\n    shouldListenRef.current = true;\n    if (recognitionRef.current && !listening) {\n      recognitionRef.current.start();\n      setListening(true);\n    }\n  };\n\n  const stopListening = (options = {}) => {\n    if (!options.temporary) {\n      shouldListenRef.current = false;\n    }\n    recognitionRef.current?.stop();\n    setListening(false);\n  };\n\n  return {\n    listening,\n    startListening,\n    stopListening,\n    error\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}