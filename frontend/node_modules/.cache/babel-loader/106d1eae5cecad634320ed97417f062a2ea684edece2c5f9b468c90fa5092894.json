{"ast":null,"code":"var _jsxFileName = \"/Users/abhayagarwal/IdeaProjects/UPI-saathi/frontend/src/components/VoiceInterface.js\",\n  _s = $RefreshSig$();\n// src/components/VoiceInterface.js\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useVoice } from '../hooks/useVoice';\nimport { parseVoiceCommand } from '../utils/voiceCommands';\nimport { toast } from 'react-toastify';\nimport { useAccessibility } from '../contexts/AllContexts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst parseAmount = text => {\n  const match = text.match(/(\\d+(\\.\\d+)?)/);\n  if (!match) return null;\n  return parseFloat(match[1]);\n};\nconst normalizeRecipient = text => {\n  const cleaned = text.replace(/(to\\s+)?send money to/i, '').replace(/^to\\s+/i, '').trim();\n  if (!cleaned) return '';\n  if (cleaned.includes('@')) return cleaned;\n  return `${cleaned.replace(/\\s+/g, '').toLowerCase()}@upi`;\n};\nconst VoiceInterface = ({\n  onAction\n}) => {\n  _s();\n  const {\n    settings,\n    speak\n  } = useAccessibility();\n  const [flow, setFlow] = useState({\n    step: 'idle',\n    recipientUpiId: '',\n    amount: ''\n  });\n  const flowRef = useRef({\n    step: 'idle',\n    recipientUpiId: '',\n    amount: ''\n  });\n  const lastPromptRef = useRef('');\n  const [lastPrompt, setLastPrompt] = useState('');\n  const autoStartedRef = useRef(false);\n  const [needsGesture, setNeedsGesture] = useState(false);\n  const isSpeakingRef = useRef(false);\n  const resumeTimeoutRef = useRef(null);\n  const say = message => {\n    lastPromptRef.current = message;\n    setLastPrompt(message);\n    toast.info(message);\n    if (!settings.enableVoiceNavigation) return;\n    // Avoid speaking while listening to prevent recognition aborts.\n    stopListening({\n      temporary: true\n    });\n    isSpeakingRef.current = true;\n    if (!('speechSynthesis' in window)) {\n      speak(message);\n      return;\n    }\n    isSpeakingRef.current = true;\n    if (resumeTimeoutRef.current) {\n      clearTimeout(resumeTimeoutRef.current);\n    }\n    window.speechSynthesis.cancel();\n    const utterance = new SpeechSynthesisUtterance(message);\n    utterance.lang = 'en-IN';\n    utterance.rate = settings.voiceSpeed || 1.0;\n    utterance.onend = () => {\n      isSpeakingRef.current = false;\n      try {\n        startListening();\n      } catch (e) {\n        // ignore\n      }\n    };\n    utterance.onerror = () => {\n      isSpeakingRef.current = false;\n      try {\n        startListening();\n      } catch (e) {\n        // ignore\n      }\n    };\n    window.speechSynthesis.speak(utterance);\n    if (resumeTimeoutRef.current) {\n      clearTimeout(resumeTimeoutRef.current);\n    }\n    resumeTimeoutRef.current = setTimeout(() => {\n      isSpeakingRef.current = false;\n      try {\n        startListening();\n      } catch (e) {\n        // ignore\n      }\n    }, 1200);\n  };\n  const {\n    listening,\n    startListening,\n    stopListening,\n    error\n  } = useVoice({\n    onCommand: text => {\n      const transcript = text.trim().toLowerCase();\n      if (isSpeakingRef.current) return;\n      const lastPrompt = lastPromptRef.current.toLowerCase();\n      const commandWords = ['confirm', 'cancel', 'help', 'send money'];\n      const isCommandWord = commandWords.some(word => transcript.includes(word));\n      if (!isCommandWord && lastPrompt) {\n        const longEnough = transcript.length > 6;\n        if (longEnough && (transcript.includes(lastPrompt) || lastPrompt.includes(transcript))) {\n          return;\n        }\n      }\n      if (transcript.includes('to send money to') || transcript.includes('how much would you like to send')) {\n        return;\n      }\n      if (transcript.includes('say help') || transcript.includes('voice mode is enabled')) {\n        return;\n      }\n      const currentFlow = flowRef.current;\n      if (transcript.includes('cancel') && currentFlow.step !== 'idle') {\n        const reset = {\n          step: 'idle',\n          recipientUpiId: '',\n          amount: ''\n        };\n        setFlow(reset);\n        flowRef.current = reset;\n        toast.info('Cancelled voice transaction');\n        if (settings.enableVoiceNavigation) {\n          speak('Cancelled voice transaction.');\n        }\n        return;\n      }\n      if (transcript.includes('repeat') && lastPromptRef.current) {\n        say(lastPromptRef.current);\n        return;\n      }\n      if (transcript.includes('send money')) {\n        if (transcript.includes('to')) {\n          const recipientUpiId = normalizeRecipient(transcript);\n          if (!recipientUpiId) {\n            say('Please say the recipient UPI ID.');\n            const next = {\n              step: 'awaitingRecipient',\n              recipientUpiId: '',\n              amount: ''\n            };\n            setFlow(next);\n            flowRef.current = next;\n            return;\n          }\n          const nextPrompt = 'How much would you like to send?';\n          say(nextPrompt);\n          const next = {\n            step: 'awaitingAmount',\n            recipientUpiId,\n            amount: ''\n          };\n          setFlow(next);\n          flowRef.current = next;\n          return;\n        }\n        const prompt = 'Whom would you like to send money to?';\n        say(prompt);\n        const next = {\n          step: 'awaitingRecipient',\n          recipientUpiId: '',\n          amount: ''\n        };\n        setFlow(next);\n        flowRef.current = next;\n        return;\n      }\n      if (currentFlow.step === 'awaitingRecipient') {\n        const recipientUpiId = normalizeRecipient(transcript);\n        const prompt = 'How much would you like to send?';\n        say(prompt);\n        const next = {\n          step: 'awaitingAmount',\n          recipientUpiId,\n          amount: ''\n        };\n        setFlow(next);\n        flowRef.current = next;\n        return;\n      }\n      if (currentFlow.step === 'awaitingAmount') {\n        const amount = parseAmount(transcript);\n        if (!amount) {\n          const prompt = 'Please say the amount in rupees.';\n          say(prompt);\n          return;\n        }\n        if (!currentFlow.recipientUpiId) {\n          const prompt = 'Please say the recipient name or UPI ID.';\n          say(prompt);\n          const next = {\n            step: 'awaitingRecipient',\n            recipientUpiId: '',\n            amount: ''\n          };\n          setFlow(next);\n          flowRef.current = next;\n          return;\n        }\n        const draft = {\n          action: 'VOICE_SEND_DRAFT',\n          recipientUpiId: currentFlow.recipientUpiId,\n          amount\n        };\n        const reset = {\n          step: 'idle',\n          recipientUpiId: '',\n          amount: ''\n        };\n        setFlow(reset);\n        flowRef.current = reset;\n        say('Draft created. Opening send money screen.');\n        console.log('ðŸŽ¯ Voice Draft:', draft);\n        onAction === null || onAction === void 0 ? void 0 : onAction(draft);\n        return;\n      }\n      const command = parseVoiceCommand(transcript);\n      console.log('ðŸ§  Command:', command);\n      if (command.action === 'HELP') {\n        say('You can say: send money, show balance, show transactions, settings, fraud alerts, trusted contacts, go back, or logout.');\n        return;\n      }\n      if (command.action === 'CONFIRM_TRANSACTION') {\n        if (settings.enableVoiceNavigation) {\n          speak('Confirming.');\n        }\n        window.dispatchEvent(new CustomEvent('voice:confirm'));\n        return;\n      }\n      if (command.action === 'CANCEL_TRANSACTION') {\n        if (settings.enableVoiceNavigation) {\n          speak('Cancelling.');\n        }\n        window.dispatchEvent(new CustomEvent('voice:cancel'));\n        return;\n      }\n      if (command.action === 'UNKNOWN') {\n        if (lastPromptRef.current.includes('recipient')) {\n          const recipientUpiId = normalizeRecipient(transcript);\n          const nextPrompt = 'How much would you like to send?';\n          say(nextPrompt);\n          const next = {\n            step: 'awaitingAmount',\n            recipientUpiId,\n            amount: ''\n          };\n          setFlow(next);\n          flowRef.current = next;\n          return;\n        }\n        if (lastPromptRef.current.includes('amount')) {\n          const amount = parseAmount(transcript);\n          if (amount) {\n            const draft = {\n              action: 'VOICE_SEND_DRAFT',\n              recipientUpiId: currentFlow.recipientUpiId,\n              amount\n            };\n            const reset = {\n              step: 'idle',\n              recipientUpiId: '',\n              amount: ''\n            };\n            setFlow(reset);\n            flowRef.current = reset;\n            onAction === null || onAction === void 0 ? void 0 : onAction(draft);\n            return;\n          }\n        }\n        toast.info('Sorry, I did not understand that.');\n        return;\n      }\n      onAction === null || onAction === void 0 ? void 0 : onAction(command);\n    }\n  });\n  useEffect(() => {\n    if (!settings.enableVoiceNavigation) return;\n    if (autoStartedRef.current || listening) return;\n    try {\n      startListening();\n      autoStartedRef.current = true;\n      say('Voice mode is enabled. Say help to hear commands.');\n    } catch (e) {\n      // Browser may block without user gesture.\n    }\n  }, [listening, settings.enableVoiceNavigation, startListening, speak]);\n  useEffect(() => {\n    if (!settings.enableVoiceNavigation || listening) return;\n    setNeedsGesture(true);\n    const enableOnGesture = () => {\n      try {\n        startListening();\n        setNeedsGesture(false);\n        say('Voice mode is enabled. Say help to hear commands.');\n      } catch (e) {\n        // ignore\n      }\n      window.removeEventListener('click', enableOnGesture);\n      window.removeEventListener('keydown', enableOnGesture);\n    };\n    window.addEventListener('click', enableOnGesture);\n    window.addEventListener('keydown', enableOnGesture);\n    return () => {\n      window.removeEventListener('click', enableOnGesture);\n      window.removeEventListener('keydown', enableOnGesture);\n    };\n  }, [listening, settings.enableVoiceNavigation, startListening]);\n  useEffect(() => {\n    if (!error) return;\n    const normalized = String(error).toLowerCase();\n    const blocked = ['not-allowed', 'service-not-allowed', 'audio-capture', 'notallowederror'];\n    if (blocked.some(code => normalized.includes(code))) {\n      setNeedsGesture(true);\n      toast.info('Tap to enable microphone for voice commands.');\n    }\n  }, [error]);\n  const handleEnableVoice = () => {\n    try {\n      startListening();\n      setNeedsGesture(false);\n      say('Voice mode is enabled. Say help to hear commands.');\n    } catch (e) {\n      // ignore\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"subtle\",\n      children: [\"Voice: \", listening ? 'Listening' : 'Idle']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: 'red'\n      },\n      children: [\"Voice error: \", String(error), \". Please allow microphone access in the browser.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 9\n    }, this), lastPrompt && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"subtle\",\n      style: {\n        marginTop: '8px'\n      },\n      children: lastPrompt\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 9\n    }, this), needsGesture && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        marginTop: '12px',\n        background: '#fff7ed'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"subtle\",\n        children: \"Tap anywhere to enable microphone access for voice commands.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 307,\n    columnNumber: 5\n  }, this);\n};\n_s(VoiceInterface, \"YKfTBlac38OV0Vg9yQQzN5cOUIE=\", false, function () {\n  return [useAccessibility, useVoice];\n});\n_c = VoiceInterface;\nexport default VoiceInterface;\nvar _c;\n$RefreshReg$(_c, \"VoiceInterface\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useVoice","parseVoiceCommand","toast","useAccessibility","jsxDEV","_jsxDEV","parseAmount","text","match","parseFloat","normalizeRecipient","cleaned","replace","trim","includes","toLowerCase","VoiceInterface","onAction","_s","settings","speak","flow","setFlow","step","recipientUpiId","amount","flowRef","lastPromptRef","lastPrompt","setLastPrompt","autoStartedRef","needsGesture","setNeedsGesture","isSpeakingRef","resumeTimeoutRef","say","message","current","info","enableVoiceNavigation","stopListening","temporary","window","clearTimeout","speechSynthesis","cancel","utterance","SpeechSynthesisUtterance","lang","rate","voiceSpeed","onend","startListening","e","onerror","setTimeout","listening","error","onCommand","transcript","commandWords","isCommandWord","some","word","longEnough","length","currentFlow","reset","next","nextPrompt","prompt","draft","action","console","log","command","dispatchEvent","CustomEvent","enableOnGesture","removeEventListener","addEventListener","normalized","String","blocked","code","handleEnableVoice","children","className","fileName","_jsxFileName","lineNumber","columnNumber","style","color","marginTop","background","_c","$RefreshReg$"],"sources":["/Users/abhayagarwal/IdeaProjects/UPI-saathi/frontend/src/components/VoiceInterface.js"],"sourcesContent":["// src/components/VoiceInterface.js\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useVoice } from '../hooks/useVoice';\nimport { parseVoiceCommand } from '../utils/voiceCommands';\nimport { toast } from 'react-toastify';\nimport { useAccessibility } from '../contexts/AllContexts';\n\nconst parseAmount = (text) => {\n  const match = text.match(/(\\d+(\\.\\d+)?)/);\n  if (!match) return null;\n  return parseFloat(match[1]);\n};\n\nconst normalizeRecipient = (text) => {\n  const cleaned = text\n    .replace(/(to\\s+)?send money to/i, '')\n    .replace(/^to\\s+/i, '')\n    .trim();\n  if (!cleaned) return '';\n  if (cleaned.includes('@')) return cleaned;\n  return `${cleaned.replace(/\\s+/g, '').toLowerCase()}@upi`;\n};\n\nconst VoiceInterface = ({ onAction }) => {\n  const { settings, speak } = useAccessibility();\n  const [flow, setFlow] = useState({\n    step: 'idle',\n    recipientUpiId: '',\n    amount: ''\n  });\n  const flowRef = useRef({\n    step: 'idle',\n    recipientUpiId: '',\n    amount: ''\n  });\n  const lastPromptRef = useRef('');\n  const [lastPrompt, setLastPrompt] = useState('');\n  const autoStartedRef = useRef(false);\n  const [needsGesture, setNeedsGesture] = useState(false);\n  const isSpeakingRef = useRef(false);\n  const resumeTimeoutRef = useRef(null);\n\n  const say = (message) => {\n    lastPromptRef.current = message;\n    setLastPrompt(message);\n    toast.info(message);\n    if (!settings.enableVoiceNavigation) return;\n    // Avoid speaking while listening to prevent recognition aborts.\n    stopListening({ temporary: true });\n    isSpeakingRef.current = true;\n    if (!('speechSynthesis' in window)) {\n      speak(message);\n      return;\n    }\n    isSpeakingRef.current = true;\n    if (resumeTimeoutRef.current) {\n      clearTimeout(resumeTimeoutRef.current);\n    }\n    window.speechSynthesis.cancel();\n    const utterance = new SpeechSynthesisUtterance(message);\n    utterance.lang = 'en-IN';\n    utterance.rate = settings.voiceSpeed || 1.0;\n    utterance.onend = () => {\n      isSpeakingRef.current = false;\n      try {\n        startListening();\n      } catch (e) {\n        // ignore\n      }\n    };\n    utterance.onerror = () => {\n      isSpeakingRef.current = false;\n      try {\n        startListening();\n      } catch (e) {\n        // ignore\n      }\n    };\n    window.speechSynthesis.speak(utterance);\n    if (resumeTimeoutRef.current) {\n      clearTimeout(resumeTimeoutRef.current);\n    }\n    resumeTimeoutRef.current = setTimeout(() => {\n      isSpeakingRef.current = false;\n      try {\n        startListening();\n      } catch (e) {\n        // ignore\n      }\n    }, 1200);\n  };\n\n  const { listening, startListening, stopListening, error } = useVoice({\n    onCommand: (text) => {\n      const transcript = text.trim().toLowerCase();\n      if (isSpeakingRef.current) return;\n      const lastPrompt = lastPromptRef.current.toLowerCase();\n      const commandWords = ['confirm', 'cancel', 'help', 'send money'];\n      const isCommandWord = commandWords.some((word) => transcript.includes(word));\n      if (!isCommandWord && lastPrompt) {\n        const longEnough = transcript.length > 6;\n        if (longEnough && (transcript.includes(lastPrompt) || lastPrompt.includes(transcript))) {\n          return;\n        }\n      }\n      if (transcript.includes('to send money to') || transcript.includes('how much would you like to send')) {\n        return;\n      }\n      if (transcript.includes('say help') || transcript.includes('voice mode is enabled')) {\n        return;\n      }\n\n      const currentFlow = flowRef.current;\n\n      if (transcript.includes('cancel') && currentFlow.step !== 'idle') {\n        const reset = { step: 'idle', recipientUpiId: '', amount: '' };\n        setFlow(reset);\n        flowRef.current = reset;\n        toast.info('Cancelled voice transaction');\n        if (settings.enableVoiceNavigation) {\n          speak('Cancelled voice transaction.');\n        }\n        return;\n      }\n\n      if (transcript.includes('repeat') && lastPromptRef.current) {\n        say(lastPromptRef.current);\n        return;\n      }\n\n      if (transcript.includes('send money')) {\n        if (transcript.includes('to')) {\n          const recipientUpiId = normalizeRecipient(transcript);\n          if (!recipientUpiId) {\n            say('Please say the recipient UPI ID.');\n            const next = { step: 'awaitingRecipient', recipientUpiId: '', amount: '' };\n            setFlow(next);\n            flowRef.current = next;\n            return;\n          }\n          const nextPrompt = 'How much would you like to send?';\n          say(nextPrompt);\n          const next = { step: 'awaitingAmount', recipientUpiId, amount: '' };\n          setFlow(next);\n          flowRef.current = next;\n          return;\n        }\n\n        const prompt = 'Whom would you like to send money to?';\n        say(prompt);\n        const next = { step: 'awaitingRecipient', recipientUpiId: '', amount: '' };\n        setFlow(next);\n        flowRef.current = next;\n        return;\n      }\n\n      if (currentFlow.step === 'awaitingRecipient') {\n        const recipientUpiId = normalizeRecipient(transcript);\n        const prompt = 'How much would you like to send?';\n        say(prompt);\n        const next = { step: 'awaitingAmount', recipientUpiId, amount: '' };\n        setFlow(next);\n        flowRef.current = next;\n        return;\n      }\n\n      if (currentFlow.step === 'awaitingAmount') {\n        const amount = parseAmount(transcript);\n        if (!amount) {\n          const prompt = 'Please say the amount in rupees.';\n          say(prompt);\n          return;\n        }\n        if (!currentFlow.recipientUpiId) {\n          const prompt = 'Please say the recipient name or UPI ID.';\n          say(prompt);\n          const next = { step: 'awaitingRecipient', recipientUpiId: '', amount: '' };\n          setFlow(next);\n          flowRef.current = next;\n          return;\n        }\n        const draft = {\n          action: 'VOICE_SEND_DRAFT',\n          recipientUpiId: currentFlow.recipientUpiId,\n          amount\n        };\n        const reset = { step: 'idle', recipientUpiId: '', amount: '' };\n        setFlow(reset);\n        flowRef.current = reset;\n        say('Draft created. Opening send money screen.');\n        console.log('ðŸŽ¯ Voice Draft:', draft);\n        onAction?.(draft);\n        return;\n      }\n\n      const command = parseVoiceCommand(transcript);\n      console.log('ðŸ§  Command:', command);\n      if (command.action === 'HELP') {\n        say('You can say: send money, show balance, show transactions, settings, fraud alerts, trusted contacts, go back, or logout.');\n        return;\n      }\n\n      if (command.action === 'CONFIRM_TRANSACTION') {\n        if (settings.enableVoiceNavigation) {\n          speak('Confirming.');\n        }\n        window.dispatchEvent(new CustomEvent('voice:confirm'));\n        return;\n      }\n\n      if (command.action === 'CANCEL_TRANSACTION') {\n        if (settings.enableVoiceNavigation) {\n          speak('Cancelling.');\n        }\n        window.dispatchEvent(new CustomEvent('voice:cancel'));\n        return;\n      }\n\n      if (command.action === 'UNKNOWN') {\n        if (lastPromptRef.current.includes('recipient')) {\n          const recipientUpiId = normalizeRecipient(transcript);\n          const nextPrompt = 'How much would you like to send?';\n          say(nextPrompt);\n          const next = { step: 'awaitingAmount', recipientUpiId, amount: '' };\n          setFlow(next);\n          flowRef.current = next;\n          return;\n        }\n        if (lastPromptRef.current.includes('amount')) {\n          const amount = parseAmount(transcript);\n          if (amount) {\n            const draft = {\n              action: 'VOICE_SEND_DRAFT',\n              recipientUpiId: currentFlow.recipientUpiId,\n              amount\n            };\n            const reset = { step: 'idle', recipientUpiId: '', amount: '' };\n            setFlow(reset);\n            flowRef.current = reset;\n            onAction?.(draft);\n            return;\n          }\n        }\n        toast.info('Sorry, I did not understand that.');\n        return;\n      }\n\n      onAction?.(command);\n    }\n  });\n\n  useEffect(() => {\n    if (!settings.enableVoiceNavigation) return;\n    if (autoStartedRef.current || listening) return;\n    try {\n      startListening();\n      autoStartedRef.current = true;\n      say('Voice mode is enabled. Say help to hear commands.');\n    } catch (e) {\n      // Browser may block without user gesture.\n    }\n  }, [listening, settings.enableVoiceNavigation, startListening, speak]);\n\n  useEffect(() => {\n    if (!settings.enableVoiceNavigation || listening) return;\n    setNeedsGesture(true);\n    const enableOnGesture = () => {\n      try {\n        startListening();\n        setNeedsGesture(false);\n        say('Voice mode is enabled. Say help to hear commands.');\n      } catch (e) {\n        // ignore\n      }\n      window.removeEventListener('click', enableOnGesture);\n      window.removeEventListener('keydown', enableOnGesture);\n    };\n    window.addEventListener('click', enableOnGesture);\n    window.addEventListener('keydown', enableOnGesture);\n    return () => {\n      window.removeEventListener('click', enableOnGesture);\n      window.removeEventListener('keydown', enableOnGesture);\n    };\n  }, [listening, settings.enableVoiceNavigation, startListening]);\n\n  useEffect(() => {\n    if (!error) return;\n    const normalized = String(error).toLowerCase();\n    const blocked = ['not-allowed', 'service-not-allowed', 'audio-capture', 'notallowederror'];\n    if (blocked.some((code) => normalized.includes(code))) {\n      setNeedsGesture(true);\n      toast.info('Tap to enable microphone for voice commands.');\n    }\n  }, [error]);\n\n  const handleEnableVoice = () => {\n    try {\n      startListening();\n      setNeedsGesture(false);\n      say('Voice mode is enabled. Say help to hear commands.');\n    } catch (e) {\n      // ignore\n    }\n  };\n\n  return (\n    <div>\n      <p className=\"subtle\">Voice: {listening ? 'Listening' : 'Idle'}</p>\n      {error && (\n        <p style={{ color: 'red' }}>\n          Voice error: {String(error)}. Please allow microphone access in the browser.\n        </p>\n      )}\n      {lastPrompt && (\n        <p className=\"subtle\" style={{ marginTop: '8px' }}>{lastPrompt}</p>\n      )}\n      {needsGesture && (\n        <div className=\"card\" style={{ marginTop: '12px', background: '#fff7ed' }}>\n          <p className=\"subtle\">\n            Tap anywhere to enable microphone access for voice commands.\n          </p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default VoiceInterface;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}